<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Crop Recommendation</title>
  <!-- Bootstrap CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container my-4">
    <h1 class="mb-4">Crop Recommendation System</h1>
    <div class="row">
      <!-- Left column: Form with outline -->
      <div class="col-md-6 border rounded p-4">
        <form id="cropForm" class="d-flex flex-column gap-3">
          <div class="mb-2">
            <label for="soil_pH" class="form-label">Soil pH: (Decimal values, average is 6.0-7.0)</label>
            <input type="number" step="0.1" name="soil_pH" id="soil_pH" class="form-control" required>
          </div>
          <div class="mb-2">
            <label for="microbes" class="form-label">Microbial Activity: (Decimal values, average is 3.0-5.0)</label>
            <input type="number" step="0.1" name="microbes" id="microbes" class="form-control" required>
          </div>
          <div class="mb-2">
            <label for="phosphates" class="form-label">Phosphates Ppm Level (Solid values, average is 10-50)</label>
            <input type="number" name="phosphates" id="phosphates" class="form-control" required>
          </div>
          <div class="mb-2">
            <label for="potassium" class="form-label">Potassium Ppm Level (Solid values, average is 140-200)</label>
            <input type="number" name="potassium" id="potassium" class="form-control" required>
          </div>
          <div class="mb-2">
            <label for="nitrates" class="form-label">Nitrates Level (Solid values, avarage is 10-20)</label>
            <input type="number" name="nitrates" id="nitrates" class="form-control" required>
          </div>
          <div class="mb-3">
            <label for="aeration_compaction" class="form-label">Aeration/Compaction (Solid values, 0-5):</label>
            <input type="number" step="0.1" name="aeration_compaction" id="aeration_compaction" class="form-control" required>
          </div>
          <button type="submit" class="btn btn-primary align-self-start">Get Recommendation</button>
        </form>
      </div>

      <!-- Right column: Output box with outline -->
      <div class="col-md-6 border rounded p-4 d-flex align-items-center justify-content-center">
        <h2 id="result" class="text-center w-100"></h2>
      </div>
    </div>
  </div>f
  
  <script>
    const cropData = [
  { "crop": "Lettuce", "soil_pH": 6.0, "microbes": 4.5, "phosphates": 20, "potassium": 150, "nitrates": 10, "aeration_compaction": 3 },
  { "crop": "Tomato", "soil_pH": 6.5, "microbes": 3.5, "phosphates": 40, "potassium": 180, "nitrates": 20, "aeration_compaction": 4 },
  { "crop": "Beans", "soil_pH": 6.8, "microbes": 4.0, "phosphates": 35, "potassium": 160, "nitrates": 15, "aeration_compaction": 3 },
  { "crop": "Spinach", "soil_pH": 6.2, "microbes": 4.7, "phosphates": 25, "potassium": 140, "nitrates": 12, "aeration_compaction": 5 },
  { "crop": "Kale", "soil_pH": 6.3, "microbes": 3.8, "phosphates": 30, "potassium": 170, "nitrates": 18, "aeration_compaction": 4 },
  { "crop": "Broccoli", "soil_pH": 6.5, "microbes": 4.2, "phosphates": 35, "potassium": 160, "nitrates": 20, "aeration_compaction": 4 },
  { "crop": "Carrot", "soil_pH": 6.2, "microbes": 4.0, "phosphates": 30, "potassium": 150, "nitrates": 15, "aeration_compaction": 3 },
  { "crop": "Peas", "soil_pH": 6.5, "microbes": 4.5, "phosphates": 25, "potassium": 140, "nitrates": 10, "aeration_compaction": 3 },
  { "crop": "Chard", "soil_pH": 6.3, "microbes": 4.3, "phosphates": 30, "potassium": 160, "nitrates": 18, "aeration_compaction": 4 },
  { "crop": "Radish", "soil_pH": 6.0, "microbes": 4.0, "phosphates": 20, "potassium": 130, "nitrates": 12, "aeration_compaction": 3 },
  { "crop": "Arugula", "soil_pH": 6.2, "microbes": 4.1, "phosphates": 25, "potassium": 140, "nitrates": 14, "aeration_compaction": 3 },
  { "crop": "Mustard Greens", "soil_pH": 6.3, "microbes": 4.2, "phosphates": 28, "potassium": 150, "nitrates": 16, "aeration_compaction": 4 },
  { "crop": "Bok Choy", "soil_pH": 6.5, "microbes": 4.3, "phosphates": 30, "potassium": 160, "nitrates": 18, "aeration_compaction": 4 },
  { "crop": "Beets", "soil_pH": 6.4, "microbes": 4.0, "phosphates": 32, "potassium": 155, "nitrates": 17, "aeration_compaction": 3 },
  { "crop": "Turnips", "soil_pH": 6.3, "microbes": 4.1, "phosphates": 30, "potassium": 150, "nitrates": 16, "aeration_compaction": 3 },
  { "crop": "Cabbage", "soil_pH": 6.5, "microbes": 4.2, "phosphates": 35, "potassium": 160, "nitrates": 20, "aeration_compaction": 4 },
  { "crop": "Zucchini", "soil_pH": 6.0, "microbes": 4.0, "phosphates": 28, "potassium": 150, "nitrates": 15, "aeration_compaction": 3 },
  { "crop": "Cucumber", "soil_pH": 6.2, "microbes": 4.1, "phosphates": 30, "potassium": 155, "nitrates": 16, "aeration_compaction": 3 },
  { "crop": "Squash", "soil_pH": 6.0, "microbes": 4.0, "phosphates": 28, "potassium": 150, "nitrates": 15, "aeration_compaction": 3 },
  { "crop": "Sweet Corn", "soil_pH": 6.5, "microbes": 4.3, "phosphates": 35, "potassium": 160, "nitrates": 20, "aeration_compaction": 4 },
  { "crop": "Almond", "soil_pH": 6.5, "microbes": 4.0, "phosphates": 35, "potassium": 160, "nitrates": 15, "aeration_compaction": 3 },
  { "crop": "Walnut", "soil_pH": 6.8, "microbes": 4.2, "phosphates": 40, "potassium": 170, "nitrates": 18, "aeration_compaction": 3 },
  { "crop": "Pecan", "soil_pH": 6.5, "microbes": 4.1, "phosphates": 30, "potassium": 150, "nitrates": 20, "aeration_compaction": 4 },
  { "crop": "Chestnut", "soil_pH": 6.0, "microbes": 3.9, "phosphates": 25, "potassium": 140, "nitrates": 12, "aeration_compaction": 3 },
  { "crop": "Hazelnut", "soil_pH": 6.2, "microbes": 4.0, "phosphates": 30, "potassium": 150, "nitrates": 14, "aeration_compaction": 3 }
]
;

    const weights = {
      soil_pH: 0.16666,
      microbes: 0.166666,
      phosphates: 0.16666,
      potassium: 0.16666,
      nitrates: 0.16666,
      aeration_compaction: 0.16666
    };

    const features = Object.keys(weights);

    // Normalize a dataset
    function normalizeData(data, featureList) {
      const mins = {};
      const maxs = {};
      featureList.forEach(f => {
        mins[f] = Math.min(...data.map(row => row[f]));
        maxs[f] = Math.max(...data.map(row => row[f]));
      });

      return data.map(row => {
        const norm = {};
        featureList.forEach(f => {
          norm[f] = (row[f] - mins[f]) / (maxs[f] - mins[f]);
        });
        norm.crop = row.crop;
        return norm;
      });
    }

    const normalizedData = normalizeData(cropData, features);

    document.getElementById("cropForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const userInput = {};
      features.forEach(f => {
        userInput[f] = parseFloat(formData.get(f));
      });

      // Normalize user input using training data mins/maxs
      const mins = {}, maxs = {};
      features.forEach(f => {
        mins[f] = Math.min(...cropData.map(row => row[f]));
        maxs[f] = Math.max(...cropData.map(row => row[f]));
      });

      const normalizedUser = {};
      features.forEach(f => {
        normalizedUser[f] = (userInput[f] - mins[f]) / (maxs[f] - mins[f]);
      });

      // Apply weights and compute distance to each crop
      let bestCrop = "";
      let bestDistance = Infinity;

      normalizedData.forEach(row => {
        let dist = 0;
        features.forEach(f => {
          const diff = (normalizedUser[f] - row[f]) * weights[f];
          dist += diff * diff;
        });
        if (dist < bestDistance) {
          bestDistance = dist;
          bestCrop = row.crop;
        }
      });

      document.getElementById("result").textContent = `Recommended Crop: ${bestCrop}`;
    });
  </script>
</body>
</html>
